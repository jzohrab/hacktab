<!doctype html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <script src='./index.js'></script>
    <script src='./sidebar.js'></script>
    <script src='./vendor/vextab/div.dev.js'></script>
    <link rel="stylesheet" type="text/css" href="./index.css">
    <title>Tabbyhack</title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PBBRWJB93Y"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-L5KCD95B5Z');
    </script>

  </head>
  <body onload="onloadBody()">

    <div class="sidenav">
      <div class="toolname">
        <p>Tabbyhack</p>
      </div>
      <div class="navlinks">
        <a href="#" onclick="openPopup('menuUsage');">Usage</a>
        <a href="#" onclick="openPopup('menuEditing');">Editing</a>
        <a href="#" onclick="openPopup('menuDemo');">Demo</a>
        <a href="#" onclick="openPopup('menuFaq');">FAQ/NAQ</a>
        <a href="#" onclick="openPopup('menuAbout');">About</a>
      </div>
    </div>

    <div class="main">

      <div id="bannerDiv">
        <p>Play your guitar and generate tab &mdash; see <a href="#" onclick="openPopup('menuUsage');">Usage</a> if you're new.  Welcome and good luck!</p>
      </div>

      <div id="userSpecsDiv">
        <p>Use fret range:
          min = <input type="text" style="width: 20px;" id="minFret" value="0" oninput="this.value = this.value.replace(/[^0-9]/g, '');" />,
          max = <input type="text" style="width: 20px;" id="maxFret" value="12" oninput="this.value = this.value.replace(/[^0-9]/g, '');" />
        </p>
        <div class="slidecontainer">
          Mic sensitivity:
          <input class="slider" id="MicSensSlider" type="range" min="25" max="800" value="400" oninput="updateMicSensitivity(this)">
          <input type="text" id="micsensitivity" value="400" style="width: 30px; border: none;"/> ms
        </div>
        
        <p>Extra tabbing options:
          <input type="text" style="width: 250px;" id="vextabopts" />
        </p>
      </div>

      <div id="userControls">
        <button type="button" id="btnStart" onclick="startRecord();">Start</button>
        <button type="button" id="btnStop" onclick="stopRecord();" disabled>Stop</button>
        <button type="button" id="btnFreeze" onclick="stopEditing();">Stop editing</button>
        <span id="rawnote">Current note: </span>
      </div>

      <div id="keyboardcontrols">
        <p>When you click &quot;Stop&quot;, you can edit the notes &mdash; see <a href="#" onclick="openPopup('menuUsage');">Usage</a> for available keys.</p>
      </div>

      <!-- mini editor -->
      <div class="vexbox">
        <div id="vextabmini" class="vextab-auto" width=700 scale=0.8 editor="true" editor-width=10 editor-height=10>
        </div>
      </div>

      <!-- editor progress bar -->
      <div class="prog-border">
        <div id="prog-bar"></div>
      </div>

      <!-- Fretboard -->
      <div id="fretboard">
      </div>

      <!-- Tab links -->
      <div class="tab">
        <button id="btnVextab" class="tablinks" onclick="openTab('btnVextab', 'finalvextab')">Vextab</button>
        <button id="btnAscii" class="tablinks" onclick="openTab('btnAscii', 'finaltab')">Ascii</button>
      </div>

      <div id="finaltab" class="tabcontent">
        <div id="tabdest"></div>
        <div id="controls-tab">
          <button type="button" id="btnCopy" onclick="copyTab();" disabled>Copy</button>&nbsp;<span id="copied">Copied!</span>
        </div>
      </div>

      <div id="finalvextab" class="tabcontent">
        <div id="vextabdest" class="vextab-auto" width=700 scale=0.8 editor="true" editor-width=750 editor-height=100>
        </div>
      </div>

      <!-- Popup content -->
      <div id="menuUsage" class="popupContent">
        <p class="title">Usage</p>
        <ol>
          <li>Get your guitar, tune up, and get within earshot of your mic.</li>
          <li><i>(Optional)</i> Enter the fret range -- this reduces the possible number of fretting options that the tabber will find.</li>
          <li>Click Start, and let this site access your mic.</li>
          <li>Play one note at a time, slowly (about 1 note per 1/2 second).  Tab candidate notes will appear as they're recognized.  For chords, play the strings one at a time, and don't overlap the notes.  Note you can change the app sensitivity by entering a value in the sensitivity box, but very low values may result in lots of noise being tabbed.</li>
          <li>You can specify key and time signatures using the &quot;Extra tabbing options&quot; - eg &quot;key=A time=12/8&quot;.  Note these tabbing options correspond to the Stave keywords in the <a href="https://www.vexflow.com/vextab/tutorial.html" target="_blank">Vextab tutorial</a>.</li>
          <li>Click Stop when you're done.</li>
          <li>Edit the notes using the keyboard (see "Editing").  You can check the tab you'll generate on the score, or on the Ascii tab.</li>
          <li>When you're done editing, click &quot;Stop editing&quot;, and click the &quot;Ascii&quot; tab.  Click 'Copy', and paste it wherever you need it.</li>
        </ol>
      </div>

      <div id="menuEditing" class="popupContent">
        <p class="title">Editing</p>
        <p>When you've recorded all your notes, you'll see an underline under the first note ... that's a cursor indicating the note you're editing.</p>
        <ul>
          <li>left/right arrow: move to previous/next note</li>
          <li>up/down arrow: move the note to a different string, if that same note can be fretted on the new string.  For example, if you specify a fret range of 1 to 5, you can't play a &quot;C&quot; on the top E sting.</li>
          <li>c: toggle note to be a chord, or chord back to its notes.</li>
          <li>+, - : speed up or slow down the current note.</li>
          <li>. : toggle the dot for the current note</li>
          <li>&lt;DEL&gt;: delete the current note</li>
        </ul>
      </div>

      <div id="menuDemo" class="popupContent">
        <p class="title">A quick demo ... (WAY out of date!)</p>
        <p>This demo was recorded for version 0.0.0.0.1 of this software ... the same concepts apply, for the most part!  See Editing for other editing options.</p>
        <!-- this video is also referenced in sidebar.js, hacky. -->
        <iframe id="youtubeframe"
                width="420" height="315"
                src="https://www.youtube.com/embed/K6aIzLHKdnU">
        </iframe>
      </div>

      <div id="menuFaq" class="popupContent">
        <p class="title">FAQs and NAQs (Never Asked Questions).</p>
        <p>
          <b>"Who is this for?"</b><br />
          A: Teachers, people who want to get quick tabs, whoever finds it useful, really.
        </p>
        <p>
          <b>"Why is this so primitive?"</b><br />
          A: There are existing fully-featured tab things out there, but I wanted something that I could "dictate to" with my guitar, and that would let me quickly make ascii tabs.
        </p>
        <p>
          <b>"Why can't I play chords?"</b><br />
          A: I haven't looked into this much, but the library that this uses only distinguishes individual tones.  It's possible to extract multiple frequencies from a single chord, but that's beyond the scope of this little project.
        </p>
        <p>
          <b>"Can you make this software do x, y, z, [feature request here]?"</b><br />
          A: I welcome code contributions to the GitHub repo! (see "About" in the menu)  Unfortunately I'm dealing with a medical issue that makes extensive coding tough, so I doubt I'll be investing <i>serious</i> time into this project, unless there is a real need.  I don't know how many people will use it, though!
        </p>
        <p>
          <b>"I love it!  Where can I donate a pile of money to?"</b><br />
          A: This is a small project, done for fun and as a small contribution to any guitarists who find it interesting.  But if you <i>really</i> want to give me money, please donate that same sum to your nearest women's health org, animal shelter, or any worthy cause.  Or call that friend you've been meaning to and say hi.  Or surprise a stranger with a free coffee.  Then send me a virtual high-five, and we'll call it even.  Cheers!
        </p>
      </div>
      
      <div id="menuAbout" class="popupContent">
        <p class="title">About</p>
        <p>Tabbyhack is for hacking tab. :-P</p>
        <p>Version: 0.0.0.0.1</p>
        <p>GitHub repo: <a href="https://github.com/jzohrab/tabbyhack">tabbyhack</a> - code contributions are <b>very</b> welcome!</p>
        <p>Issues and complaints: please use GitHub issues.</p>
      </div>
      
      <!-- hidden in prod -->
      <div id="devControls">
         <p>dev controls</p>
         <button type="button" onclick="printRecord();">Raw data</button>
         <button type="button" onclick="addRandom();">Add random notes</button>
         <span id="recorded"/>
       </div>
          
    </div>
    
    <div id="popupDiv" style="display: none;">
      <div id="popupBox">
        <div class="popupCloseButton" onclick="closePopup();">&times;</div>
        <div id="popupText" />
      </div>
    </div>


  </body>
</html>

